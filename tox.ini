[tox]
envlist = py310, black, prospector, bandit, mypy

[testenv]
commands = python3 -m unittest
deps = -rrequirements.txt

[testenv:prospector]
# Run static analysis using prospector
deps = -r{toxinidir}/requirements-dev.txt
commands = prospector --no-autodetect \
               --doc-warnings \
               --test-warnings \
               --zero-exit \
               {toxinidir}/app

[testenv:black]
# Check code style
deps = -r{toxinidir}/requirements-dev.txt
commands = black --check {toxinidir}/app

[testenv:mypy]
# Check typing
deps = -r{toxinidir}/requirements-dev.txt
commands = mypy --follow-imports skip \
    --ignore-missing-imports \
    {toxinidir}/app

[testenv:bandit]
# Check for security issues
deps = -r{toxinidir}/requirements-dev.txt
commands = bandit --exit-zero {toxinidir}/app/main.py
